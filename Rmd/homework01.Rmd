---
title: "homework01"
author: "zhewei xie"
date: "2024-07-18"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include = FALSE, echo=FALSE}
# load libraries.
library(tidyverse)
library(knitr)
library(ggtext)
```

# Problem 1: playlists revisited

This problem use observed proportions/frequencies to approximate probabilities.

```{r problem1_dataset, echo=FALSE}
# read csv as data set.
plays_top50 = read.csv("../data/raw data/plays_top50.csv", header = TRUE)
```

## Part A

In the 2x2 table (Table 1) displayed below:\
**it shows** $P(\text{plays Daft Punk }|\text{ plays David Bowie})$ **as the bottom right entry,**\
shows $P(\text{plays Daft Punk }|\text{ not plays David Bowie})$ as the bottom left entry,\
shows $P(\text{not plays Daft Punk }|\text{ plays David Bowie})$ as the upper right entry,\
shows $P(\text{not plays Daft Punk }|\text{ not plays David Bowie})$ as the upper left entry.

```{r problem1_a, echo=FALSE}
# make a 2x2 table
table <- xtabs(~daft.punk + david.bowie, data = plays_top50) %>%
  # conditional on the levels of the david.bowie variable, the second variable.
  prop.table(margin = 2) %>%
  # round the entries in the table to 3 decimal places.
  round(3)

# transform to data frame
df <- as.data.frame.matrix(table)

# rename
colnames(df) <- c("not plays David Bowie", "plays David Bowie")
rownames(df) <- c("not plays Daft Punk", "plays Daft Punk")

kable(df,
      caption = "Conditional probabilities of “plays Daft Punk” and “plays David Bowie”.")
```

## Part B

Just like the frequency of Johnny Cash (Table 2) and the 2x2 table of conditional probabilities (Table 3) displayed below, it shows that:  
$P(\text{plays Johnny Cash }|\text{ plays Pink Floyd})\approx0.105$,  
$P(\text{plays Johnny Cash }|\text{ not plays Pink Floyd})\approx0.055$,  
$P(\text{plays Johnny Cash})\approx0.060$.\
Therefore:  
$P(\text{plays Johnny Cash }|\text{ plays Pink Floyd})\neq P(\text{plays Johnny Cash }|\text{ not plays Pink Floyd})\neq P(\text{plays Johnny Cash})$,  
this implies that **the events "plays Johnny Cash" and "plays Pink Floyd" are not independent.**

```{r problem1_b_1, echo=FALSE}
table <- xtabs(~johnny.cash, data = plays_top50) %>%
  prop.table() %>%
  round(3) %>%
  sprintf("%.3f", .)

df <- as.data.frame(table)

rownames(df) <- c("not plays Johnny Cash", "plays Johnny Cash")
colnames(df) <- c("Freq")

kable(df,
      caption = "Frequency of “plays Johnny Cash”.")
```

```{r problem1_b_2, echo=FALSE}
table <- xtabs(~johnny.cash + pink.floyd, data = plays_top50) %>%
  prop.table(margin = 2) %>%
  round(3)

df <- as.data.frame.matrix(table)

colnames(df) <- c("not plays Pink Floyd", "plays Pink Floyd")
rownames(df) <- c("not plays Johnny Cash", "plays Johnny Cash")

kable(df,
      caption = "Conditional probabilities of “plays Johnny Cash” and “plays Pink Floyd”.")
```

# Problem 2: Super Bowl ads

This problem use observed proportions/frequencies to approximate probabilities.

```{r problem2_dataset, echo=FALSE}
superbowl = read.csv("../data/raw data/superbowl.csv", header = TRUE)
```

## Part A

### Estimate $P(\text{danger = TRUE})$

Because $P(\text{danger = TRUE})\approx\text{\{Frequency of danger = TRUE\}}$.  
Therefore, given the frequency of danger = TRUE (Table 4) displayed below, $P(\text{danger = TRUE})\approx0.30$.

```{r problem2_a_1, echo=FALSE}
table <- xtabs(~danger, data = superbowl) %>%
  prop.table() %>%
  round(2) %>%
  sprintf("%.2f", .)

df <- as.data.frame(table)

rownames(df) <- c("danger = FALSE", "danger = TRUE")
colnames(df) <- c("Freq")

kable(df,
      caption = "Frequency of danger.")
```

### Estimate $P(\text{danger = TRUE | funny = TRUE})$

Because $P(\text{danger = TRUE | funny = TRUE})\\
\\
=\frac{P(\text{danger = TRUE, funny = TRUE})}{P(\text{funny = TRUE})}\\
\\
\approx\frac{\text{Frequency of danger = TRUE and funny = TRUE both happening}}{\text{Frequency of funny = TRUE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 5) displayed below:  
$P(\text{danger = TRUE | funny = TRUE})\approx0.39$.  

### Estimate $P(\text{danger = TRUE | funny = FALSE})$

Because $P(\text{danger = TRUE | funny = FALSE})\\
\\
=\frac{P(\text{danger = TRUE, funny = FALSE})}{P(\text{funny = FALSE})}\\
\\
\approx\frac{\text{Frequency of danger = TRUE and funny = FALSE both happening}}{\text{Frequency of funny = FALSE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 5) displayed below:  
$P(\text{danger = TRUE | funny = FALSE})\approx0.12$.

```{r problem2_a_2, echo=FALSE}
table <- xtabs(~danger + funny, data = superbowl) %>%
  prop.table(margin = 2) %>%
  round(2)

df <- as.data.frame.matrix(table)

colnames(df) <- c("funny = FALSE", "funny = TRUE")
rownames(df) <- c("danger = FALSE", "danger = TRUE")

kable(df,
      caption = "Conditional probabilities of danger and funny.")
```

### Explanation

Given the results of estimations of $P(\text{danger = TRUE})$, $P(\text{danger = TRUE | funny = TRUE})$ and $P(\text{danger = TRUE | funny = FALSE})$, it is clear that  
$P(\text{danger = TRUE})\neq P(\text{danger = TRUE | funny = TRUE})\neq P(\text{danger = TRUE | funny = FALSE})$. **In light of these numbers, it seem that ads using humor are more likely to feature danger than ads not using humor, and under the given condition, humor and danger are not independent.**

## Part B

### Estimate $P(\text{animals = TRUE})$

Because $P(\text{animals = TRUE})\approx\text{\{Frequency of animals = TRUE\}}$.  
Therefore, given the frequency of animals = TRUE (Table 6) displayed below, $P(\text{animals = TRUE})\approx0.37$.

```{r problem2_b_1, echo=FALSE}
table <- xtabs(~animals, data = superbowl) %>%
  prop.table() %>%
  round(2) %>%
  sprintf("%.2f", .)

df <- as.data.frame(table)

rownames(df) <- c("animals = FALSE", "animals = TRUE")
colnames(df) <- c("Freq")

kable(df,
      caption = "Frequency of animals.")
```

### Estimate $P(\text{animals = TRUE | use\_sex = TRUE})$

Because $P(\text{animals = TRUE | use\_sex = TRUE})\\
\\
=\frac{P(\text{animals = TRUE, use\_sex = TRUE})}{P(\text{use\_sex = TRUE})}\\
\\
\approx\frac{\text{Frequency of animals = TRUE and use\_sex = TRUE both happening}}{\text{Frequency of use\_sex = TRUE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 7) displayed below:  
$P(\text{animals = TRUE | use\_sex = TRUE})\approx0.38$.  

### Estimate $P(\text{animals = TRUE | use\_sex = FALSE})$

Because $P(\text{animals = TRUE | use\_sex = FALSE})\\
\\
=\frac{P(\text{animals = TRUE, use\_sex = FALSE})}{P(\text{use\_sex = FALSE})}\\
\\
\approx\frac{\text{Frequency of animals = TRUE and use\_sex = FALSE both happening}}{\text{Frequency of use\_sex = FALSE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 7) displayed below:  
$P(\text{animals = TRUE | use\_sex = FALSE})\approx0.37$.

```{r problem2_b_2, echo=FALSE}
table <- xtabs(~animals + use_sex, data = superbowl) %>%
  prop.table(margin = 2) %>%
  round(2)

df <- as.data.frame.matrix(table)

colnames(df) <- c("use_sex = FALSE", "use_sex = TRUE")
rownames(df) <- c("animals = FALSE", "animals = TRUE")

kable(df,
      caption = "Conditional probabilities of animals and sexuality.")
```

### Explanation

Given the results of estimations of $P(\text{animals = TRUE})$, $P(\text{animals = TRUE | use\_sex = TRUE})$ and $P(\text{animals = TRUE | use\_sex = FALSE})$, it is clear that  
$P(\text{animals = TRUE})\approx P(\text{animals = TRUE | use\_sex = TRUE})\approx P(\text{animals = TRUE | use\_sex = FALSE})$, **so it may seem that ads using sexuality are as likely to feature animals as ads not using sexuality. This implies that the events using sexuality and featuring animals are independent.**

## Part C

### Estimate $P(\text{celebrity = TRUE})$

Because $P(\text{celebrity = TRUE})\approx\text{\{Frequency of celebrity = TRUE\}}$.  
Therefore, given the frequency of celebrity = TRUE (Table 8) displayed below, $P(\text{celebrity = TRUE})\approx0.29$.

```{r problem2_c_1, echo=FALSE}
table <- xtabs(~celebrity, data = superbowl) %>%
  prop.table() %>%
  round(2) %>%
  sprintf("%.2f", .)

df <- as.data.frame(table)

rownames(df) <- c("celebrity = FALSE", "celebrity = TRUE")
colnames(df) <- c("Freq")

kable(df,
      caption = "Frequency of celebrity.")
```

### Estimate $P(\text{celebrity = TRUE | patriotic = TRUE})$

Because $P(\text{celebrity = TRUE | patriotic = TRUE})\\
\\
=\frac{P(\text{celebrity = TRUE, patriotic = TRUE})}{P(\text{patriotic = TRUE})}\\
\\
\approx\frac{\text{Frequency of celebrity = TRUE and patriotic = TRUE both happening}}{\text{Frequency of patriotic = TRUE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 9) displayed below:  
$P(\text{celebrity = TRUE | patriotic = TRUE})\approx0.29$.  

### Estimate $P(\text{celebrity = TRUE | patriotic = FALSE})$

Because $P(\text{celebrity = TRUE | patriotic = FALSE})\\
\\
=\frac{P(\text{celebrity = TRUE, patriotic = FALSE})}{P(\text{patriotic = FALSE})}\\
\\
\approx\frac{\text{Frequency of celebrity = TRUE and patriotic = FALSE both happening}}{\text{Frequency of patriotic = FALSE happening}}$.  
  
Therefore, given the 2x2 table of conditional probabilities (Table 9) displayed below:  
$P(\text{celebrity = TRUE | patriotic = FALSE})\approx0.29$.

```{r problem2_c_2, echo=FALSE}
table <- xtabs(~celebrity + patriotic, data = superbowl) %>%
  prop.table(margin = 2) %>%
  round(2)

df <- as.data.frame.matrix(table)

colnames(df) <- c("patriotic = FALSE", "patriotic = TRUE")
rownames(df) <- c("celebrity = FALSE", "celebrity = TRUE")

kable(df,
      caption = "Conditional probabilities of celebrity and patriotic.")
```

### Explanation

Given the results of estimations of $P(\text{celebrity = TRUE})$, $P(\text{celebrity = TRUE | patriotic = TRUE})$ and $P(\text{celebrity = TRUE | patriotic = FALSE})$, it is clear that  
$P(\text{celebrity = TRUE})\approx P(\text{celebrity = TRUE | patriotic = TRUE})\approx P(\text{celebrity = TRUE | patriotic = FALSE})$, **so it seem that quite credibly ads using patriotic symbolism are as likely to feature celebrity endorsement as ads not using patriotic symbolism. This implies that the events using patriotic symbolism and featuring celebrity endorsement are independent.**

# Problem 3: Beauty, or not, in the classroom

```{r problem3_dataset, echo=FALSE}
profs = read.csv("../data/raw data/profs.csv", header = TRUE)
```

## Part A

```{r problem3_a_1, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(profs) +
  geom_histogram(aes(x = eval), binwidth = 0.1) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Distribution of Course Evaluation Scores at UT Austin") +
  scale_x_continuous(limits = c(0.9, 5.1), breaks = seq(1, 5, 1)) +
  labs(x = "Course evaluation scores (score)",
    caption = "<b>Figure 1.</b> The distribution of course evaluation scores is left-skewed and concentrated around 4.0, indicating <br>that the overall rating for the professor is generally positive. And the median of eval distribution is 4.0, while <br>the iqr is 0.8.") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

```{r problem3_a_2, echo=FALSE, message=FALSE, warning=FALSE}
summarize_profs_eval <- profs %>%
  summarize(median = median(eval),
            iqr = IQR(eval),
            mode = mode(eval))
# median=4 iqr=0.8
```

## Part B

```{r problem3_b_1, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(profs) +
  geom_boxplot(aes(x = native, y = eval)) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Distribution of Course Evaluation Scores by Native English Speaker Status \nat UT Austin") +
  scale_y_continuous(limits = c(0.9, 5.1), breaks = seq(1, 5, 1)) +
  labs(x = "Native English speaker",
       y = "Course evaluation scores (score)",
  caption = "<b>Figure 2.</b> As English native speakers, instructors generally receive higher course evaluation scores <br>(median = 4), but the differences in extreme cases are more pronounced (max = 5.0, min = 2.1). <br>Non-native speakers, on the other hand, tend to have lower overall course evaluation scores (median = 3.6), <br>but these scores are relatively clustered (max = 4.6, min = 2.7).") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

```{r problem3_b_2, echo=FALSE, message=FALSE, warning=FALSE}
summarize_profs_eval_by_native <- profs %>%
  filter(native == "yes") %>%
  summarize(median = median(eval),
            iqr = IQR(eval),
            max = max(eval),
            min = min(eval))
# median 4 iqr 0.7 max 5 min 2.1
```

```{r problem3_b_3, echo=FALSE, message=FALSE, warning=FALSE}
summarize_profs_eval_by_nonative <- profs %>%
  filter(native == "no") %>%
  summarize(median = median(eval),
            iqr = IQR(eval),
            max = max(eval),
            min = min(eval))
# median 3.6 iqr 0.7 max 4.6 min 2.7
```

## Part C

```{r problem3_c_1, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(profs) +
  geom_histogram(aes(x = eval, y = ..density..), binwidth = 0.1) +
  facet_wrap(~gender, nrow = 2) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Distribution of Course Evaluation Scores by Gender at UT Austin") +
  scale_x_continuous(limits = c(0.9, 5.1), breaks = seq(1, 5, 1)) +
  labs(x = "Course evaluation scores (score)",
    caption = "<b>Figure 3.</b> Both of distributions of course evalution scores faceted by gender are left-skewed, while the <br>median course evaluation scores for male instructors (4.15) are higher than those for female instructors (3.9). <br>However, the IQR value for males (0.8) is also higher compared to females (0.7), indicating greater <br>distribution variability.") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

```{r problem3_c_2, echo=FALSE, message=FALSE, warning=FALSE}
summarize_profs_eval_male <- profs %>%
  filter(gender == 'male') %>%
  summarize(median = median(eval),
            iqr = IQR(eval))
# median=4.15 iqr=0.8
```

```{r problem3_c_3, echo=FALSE, message=FALSE, warning=FALSE}
summarize_profs_eval_female <- profs %>%
  filter(gender == 'female') %>%
  summarize(median = median(eval),
            iqr = IQR(eval))
# median=3.9 iqr=0.7
```

## Part D

```{r problem3_d_1, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(profs) +
  geom_point(aes(x = beauty, y = eval)) +
  geom_smooth(aes(x = beauty, y = eval), method = "lm") +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Association Between Physical Attractiveness and Course Evaluation Scores \nat UT Austin") +
  scale_y_continuous(limits = c(0.9, 5.1), breaks = seq(1, 5, 1)) +
  labs(x = "Physical attractiveness (rating units)",
       y = "Course evaluation scores (score)",
    caption = str_wrap("<b>Figure 4.</b> Regardless of the rating of physical attractiveness scores, course evaluation scores exhibit <br>substantial variation. And there is a weak linear correlation (correlation = 0.189) between a professor's <br>physical attractiveness and their course evaluations.")) +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

```{r problem3_d_2, echo=FALSE, message=FALSE, warning=FALSE}
cor_x <- profs$beauty
cor_y <- profs$eval

cor_xy <- cor(cor_x, cor_y)
# 0.1890391
```

# Problem 4: SAT scores for UT students

```{r problem4_dataset, echo=FALSE}
utsat = read.csv("../data/raw data/utsat.csv", header = TRUE)
```

```{r problem4, echo=FALSE}
summarize_satv <- utsat %>%
  summarize(avg = mean(SAT.V),
            sd = sd(SAT.V),
            iqr = IQR(SAT.V),
            q05 = quantile(SAT.V, 0.05),
            q25 = quantile(SAT.V, 0.25),
            q50 = quantile(SAT.V, 0.50),
            q75 = quantile(SAT.V, 0.75),
            q95 = quantile(SAT.V, 0.95))
            
summarize_satq <- utsat %>%
  summarize(avg = mean(SAT.Q),
            sd = sd(SAT.Q),
            iqr = IQR(SAT.Q),
            q05 = quantile(SAT.Q, 0.05),
            q25 = quantile(SAT.Q, 0.25),
            q50 = quantile(SAT.Q, 0.50),
            q75 = quantile(SAT.Q, 0.75),
            q95 = quantile(SAT.Q, 0.95))
            
summarize_gpa <- utsat %>%
  summarize(avg = mean(GPA),
            sd = sd(GPA),
            iqr = IQR(GPA),
            q05 = quantile(GPA, 0.05),
            q25 = quantile(GPA, 0.25),
            q50 = quantile(GPA, 0.50),
            q75 = quantile(GPA, 0.75),
            q95 = quantile(GPA, 0.95))

# use bind_rows() to combine rows.
combined_summary <- bind_rows(
  summarize_satv %>% round(0) %>% mutate(variables = "SAT.V"),
  summarize_satq %>% round(0) %>% mutate(variables = "SAT.Q"),
  summarize_gpa %>% round(2) %>% mutate(variables = "GPA")
) %>% select(variables, everything())

# Print the table
kable(combined_summary, row.names = FALSE,
      caption = "The table shows the mean, standard deviation, inter-quartile rang, 5th percentile, 25th, percentile, median (50 percentile), 75th percentile, and 95th percentile of the SAT Verbal, SAT Quantitative, and GPA (all summaries rounded to 2 decimal places). The data contains the SAT scores and graduating college GPAs for every UT student who entered UT in a specific, recent year, and went on to graduate from UT within 6 years.")
```

# Problem 5: bike sharing

```{r problem5, echo=FALSE}
bikeshare = read.csv("../data/raw data/bikeshare.csv", header = TRUE)
```

## Plot A

```{r problem5_plot_a, echo=FALSE}
avg_total_by_hr <- bikeshare %>%
  group_by(hr) %>%
  summarize(avg_total = mean(total))

ggplot(avg_total_by_hr) +
  geom_line(aes(x = hr, y = avg_total)) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Average Hourly Bike Rentals in Washington, DC (2011-12)") +
  scale_x_continuous(breaks = seq(0, 23, 1)) +
  labs(x = "Hour of day (hours, 0 = midnight)", y = "Average bike rentals (count)",
       caption = "<b>Figure 5.</b> <b>Average hourly bike rentals in Washington, DC (2011-12).</b> The distribution is bimodal, with <br>peak during the morning and evening rush hours. Meanwhile, the number of rentals during the evening rush <br>hour is significantly higher than during the morning rush hour.") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

## Plot B

```{r problem5_plot_b, echo=FALSE, message=FALSE}
avg_total_by_hr <- bikeshare %>%
  group_by(hr, workingday) %>%
  summarize(avg_total = mean(total))

ggplot(avg_total_by_hr) +
  geom_line(aes(x = hr, y = avg_total)) +
  facet_wrap(~workingday, nrow = 2, 
             labeller = as_labeller(c("0" = "weekend or holiday", "1" = "workingday"))) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Average Hourly Bike Rentals in Washington, DC (2011-12)",
          subtitle = "Faceted according to whether it is a working day") +
  scale_x_continuous(breaks = seq(0, 23, 1)) +
  labs(x = "Hour of day (hours, 0 = midnight)", y = "Average bike rentals (count)",
       caption = "<b>Figure 6.</b> <b>Average hourly bike rentals in Washington, DC (2011-2012) grouped by whether it is a <br>working day or not.</b> During working days, bike rentals peak during the morning and evening rush hours, <br>and the number of rentals is quite similar during these times. In contrast, on holidays or weekends, the <br>distribution of bike rentals is a gentle hill-like curve.") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```

## Plot C

```{r problem5_plot_c, echo=FALSE, message=FALSE}
avg_total_by_hr <- bikeshare %>%
  filter(hr == 9) %>%
  group_by(weathersit, workingday) %>%
  summarize(avg_rentals_on_9 = mean(total))

weather_labels <- c(
  "1" = "Clear, Few clouds, Partly cloudy, Partly cloudy",
  "2" = "Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist",
  "3" = "Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds",
  "4" = "Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog"
)

ggplot(avg_total_by_hr) +
  geom_col(aes(x = weathersit, y = avg_rentals_on_9)) +
  facet_wrap(~workingday, 
             labeller = as_labeller(c("0" = "weekend or holiday", "1" = "workingday"))) +
  theme(plot.caption = element_text(hjust = 0)) + 
  ggtitle("Average Bike Rentals by Weather Condition during the 9 AM hour \nin Washington, DC (2011-12)",
          subtitle = "Faceted according to whether it is a working day") +
  scale_x_continuous(limits = c(0, 5), breaks = seq(1, 4, 1)) +
  labs(x = "Weather situation code", y = "Average bike rentals (count)",
       caption = "<b>Figure 7.</b> <b>Average bike rentals grouped by weather condition and working day status during the <br>9 AM in Washington, DC (2011-12).</b> The number of bike rentals on working days is generally higher than <br>on non-working days. As the weather conditions worsen, people gradually reduce their bike rentals, but they <br>tend to tolerate bad weather more on working days than on non-working days. This is evident as bike <br>rentals on working days are almost the same under weather conditions 1 and 2, whereas they decrease on <br>non-working days. In the worst weather condition (weather situation code 4), people do not choose to travel <br>by renting bikes at all.<br><br>x-axis represent weather situation code, which has the following values:<br>– 1: Clear, Few clouds, Partly cloudy, Partly cloudy<br>– 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist<br>– 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds<br>– 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog") +
  theme(
    # use ggtext::element_markdown() to render Markdown
    plot.caption = element_markdown())
```
